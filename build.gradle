// Top-level build file where you can add configuration options common to all sub-projects/modules.
buildscript {
  repositories {
    google()
    mavenCentral()
  }
  dependencies {
    classpath libs.androidGradlePlugin
    classpath libs.kotlin.gradle
    classpath libs.dagger.hilt.androidGradlePlugin
  }
}

plugins {
  alias(libs.plugins.ksp)
}

task clean(type: Delete) {
  delete rootProject.buildDir
}

allprojects { project ->
  project.afterEvaluate {
    if (plugins.hasPlugin('com.johnbuhanan.android')) {
      android.kotlinOptions {
        jvmTarget = JavaVersion.VERSION_11.toString()
        freeCompilerArgs += "-opt-in=kotlin.RequiresOptIn"
        freeCompilerArgs += "-opt-in=kotlinx.coroutines.FlowPreview"
        freeCompilerArgs += "-opt-in=kotlinx.coroutines.ExperimentalCoroutinesApi"
      }

      kotlin {
        sourceSets {
          debug {
            kotlin.srcDir("build/generated/ksp/debug/kotlin")
          }
          release {
            kotlin.srcDir("build/generated/ksp/release/kotlin")
          }
        }
      }

      ksp {
        // To turn off navigation graphs generation:
        // (if you prefer creating NavGraph instances or you prefer using the normal NavHost)
        //        arg("compose-destinations.generateNavGraphs", "false")

        // To change the package name where the generated files will be placed
        //        arg("compose-destinations.codeGenPackageName", "your.preferred.packagename")
      }
    }
  }
}
